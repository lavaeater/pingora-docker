version: '3.8'

services:
  reverse-proxy:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: pingora-proxy
    volumes:
      - ./config.json:/usr/src/pingora/config.json:ro
      - ./certs:/certs:ro
    ports:
      - "8080:8080"
      - "8443:8443"
    environment:
      - RUST_LOG=info
    networks:
      - proxy-network
    restart: unless-stopped
    
  jellyfin:
    image: jellyfin/jellyfin
    container_name: jellyfin
    ports:
      - 8096:8096/tcp
      - 7359:7359/udp
    volumes:
      - /home/tommie/projects/jellyfin/config:/config
      - /home/tommie/projects/jellyfin/cache:/cache
      - type: bind
        source: /media/brontosaurus/media
        target: /media
    restart: unless-stopped
    networks:
      - proxy-network
    
  sickgear:
    container_name: sickgear
    image: sickgear/sickgear:latest
    environment:
      - APP_UID=1000
      - APP_GID=1000
      - TZ=UTC
    ports:
      - 8081:8081/tcp
    volumes:
      - /home/tommie/projects/jellyfin/data:/data
      - /home/tommie/Downloads/deluge/finished/tv:/incoming
      - /media/brontosaurus/media/tv:/tv
    restart: unless-stopped
    networks:
      - proxy-network

  rusty-budgets:
    build:
      context: /home/tommie/projects/rusty-budgets
      dockerfile: Dockerfile
    container_name: rusty-budgets
    ports:
      - 8666:8666/tcp
    restart: unless-stopped
    networks:
      - proxy-network

    # Example backend services (uncomment and modify as needed)
  # webapp1:
  #   image: nginx:alpine
  #   container_name: webapp1
  #   networks:
  #     - proxy-network
  #
  # webapp2:
  #   image: nginx:alpine  
  #   container_name: webapp2
  #   networks:
  #     - proxy-network

networks:
  proxy-network:
    driver: bridge
    name: proxy-network